<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>TAAA Semantic Extractor</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>TAAA Semantic Extractor</h1>
        <p>ä¸Šå‚³åŒ…å«æ‘˜è¦æ¬„ä½çš„ CSV æª”æ¡ˆï¼Œç³»çµ±å°‡ä½¿ç”¨ GPT-4o-mini è‡ªå‹•èƒå–èªç¾©é—œéµè©ã€‚</p>

        <div class="toggle-container">
            <label class="switch">
                <input type="checkbox" id="mode-toggle">
                <span class="slider round"></span>
            </label>
            <span id="mode-label">ğŸŒ äº®è‰²æ¨¡å¼</span>
        </div>

        <form id="upload-form">
            <input type="file" id="file" accept=".csv" required>
            <button type="submit">ğŸ“¤ ä¸Šå‚³ä¸¦åˆ†æ</button>
        </form>

        <div id="status">
            <div id="loading" class="dots"><span>.</span><span>.</span><span>.</span></div>
        </div>
    </div>

    <script>
        const form = document.getElementById("upload-form");
        const statusDiv = document.getElementById("status");
        const loading = document.getElementById("loading");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const fileInput = document.getElementById("file");
            if (!fileInput.files.length) return;

            const formData = new FormData();
            formData.append("file", fileInput.files[0]);
            loading.style.display = "inline-block";
            statusDiv.innerHTML = "â³ åˆ†æä¸­ï¼Œè«‹ç¨å€™...";

            const response = await fetch("/analyze_csv", { method: "POST", body: formData });
            if (response.ok) {
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "taaa_keywords.csv";
                a.click();
                statusDiv.innerHTML = "âœ… åˆ†æå®Œæˆï¼çµæœå·²ä¸‹è¼‰ã€‚";
            } else {
                statusDiv.innerHTML = "âŒ ä¸Šå‚³å¤±æ•—æˆ–ä¼ºæœå™¨éŒ¯èª¤ã€‚";
            }
            loading.style.display = "none";
        });

        const toggle = document.getElementById("mode-toggle");
        const label = document.getElementById("mode-label");
        toggle.addEventListener("change", () => {
            document.body.classList.toggle("dark-mode");
            label.textContent = toggle.checked ? "ğŸŒ™ æš—è‰²æ¨¡å¼" : "ğŸŒ äº®è‰²æ¨¡å¼";
        });
    </script>
</body>
</html>
