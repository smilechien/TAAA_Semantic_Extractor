<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TAAA Semantic–Co-Word Analyzer (Auto Mode Select)</title>
<link rel="stylesheet" href="/style.css">
</head>
<body>
<h1>TAAA Semantic–Co-Word Analyzer</h1>
<p>Upload your CSV file. The app will automatically choose:</p>
<ul>
  <li><b>Mode 1</b> – single column → Abstracts (via GPT / DOI, only 1 column)</li>
  <li><b>Mode 2</b> – multiple columns → Co-word matrix(at least 2 columns)</li>
</ul>
 

<form action="/analyze_csv" method="post" enctype="multipart/form-data">

  <label for="file">Upload CSV file:</label>
  <input type="file" id="file" name="file" accept=".csv" required>
  <button type="submit">Upload &amp; Analyze</button>
</form>

<div id="result" style="margin-top:30px;"></div>

<script>
document.getElementById('uploadForm').addEventListener('submit', async e => {
  e.preventDefault();
  const fileInput = document.getElementById('file');
  const file = fileInput.files[0];
  if (!file) return;

  const text = await file.text();
  const firstLine = text.split(/\r?\n/)[0];
  const columnCount = firstLine.split(',').length;
  const mode = columnCount === 1 ? 'mode1' : 'mode2';

  const formData = new FormData();
  formData.append('mode', mode);
  formData.append('file', file);

  document.getElementById('result').innerHTML = "⏳ Processing... please wait.";
  const res = await fetch('/analyze', { method: 'POST', body: formData });
  const html = await res.text();
  document.getElementById('result').innerHTML = html;
});
</script>

<footer>
  <p>© 2025 TAAA Semantic–Co-Word Analyzer | Automatic Mode Detection | English-only UI</p>
</footer>
</body>
</html>
